{#
  used in:
      - listing.twig
      - search
#}

{% if record is defined %}

    {% set listItem = record %}
    {% set contenttype = record.contenttype %}
    {% set listItemLink = structurelink(record) %}
{# TODO: Clanup - style is here only until Tim fixes pattern lab! #}
--><li class="list-item" style="width:100% !important;"><!--

        --><div class="item-supplementary">
        {% if (contenttype.slug in [ 'blog']) %}
            <div class="item-image">
                <a href="{{ listItemLink }}"><img src="{{ listItem.values['teaser_image']|default(listItem.values['image'])|thumbnail() }}" alt="{{ listItem.image|title }}" /></a>
            </div>
        {% elseif 'subsite' in listItem.template %}
            {% setcontent footer = 'Footer' where {id: listItem.footer, order: 'id', limit: 1} %}
            <div class="item-image">
                <a href="{{ listItemLink }}"><img src="{{ footer.values['image']|thumbnail() }}" alt="{{ footer.image|title }}" /></a>
            </div>
        {% elseif contenttype.slug == "events" %}
            <div class="item-bigdate">
                {% include 'items/_item-date-event.twig' with {record : listItem} %}
            </div>
        {% endif %}
        </div><!--

     --><div class="item-details">
        <h2 class="title"><a href="{{ listItemLink }}">{{ listItem.title|striptags }}</a></h2>

        {% if contenttype.slug in [ "blog" ] %}
            <div class="item-meta-primary">
                {# set author #}
                {% include 'items/_item-author.twig' %}
                {% include 'items/_item-readtime.twig' %}
            </div>
        {% endif %}

            <div class="item-meta-secondary">

            {% if contenttype.slug in [ "blog" ] %}
                {# set date #}
                {% include 'items/_item-date.twig' %}
                {# set tags #}
                {% include 'items/_item-tags.twig' %}
                {# set discus comments #}
                {% include 'items/_item-comments-link.twig' %}
            {% elseif contenttype.slug == "events" %}
                {# set location #}
                {% include 'items/_item-location.twig' %}
                {# set tags #}
                {% include 'items/_item-tags.twig' %}
            {% elseif (contenttype.slug in [ "structures" ]) %}
                {% include 'items/_item-date.twig' with { date: listItem.date_start } %}
                <span>to: </span>
                {% include 'items/_item-date.twig' with { date: listItem.date_end } %}
                <br />
                {# set tags #}
                {% include 'items/_item-tags.twig' %}
            {% endif %}
            </div>

            <div class="item-preview">
                {% if (contenttype.slug in [ "blog" ]) %}
                    {{ listItem.excerpt(app.config.get('general/excerpt_length')) }}
                {% else %}
                    {{ listItem.teaser }}
                {% endif %}
            </div>
        </div>
    </li><!--
{% endif %}
